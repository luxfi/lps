---
lp: 100
title: NIST Post-Quantum Cryptography Integration for Lux Network
description: Integrates NIST PQC (ML-KEM, ML-DSA) and hybrid modes into Lux for quantum-resistant security.
author: Lux Network Team
type: Standards Track
category: Core
status: Draft
created: 2024-12-20
requires: LP-4, LP-5
---

# LP-100: NIST Post-Quantum Cryptography Integration for Lux Network

## Abstract

This proposal integrates NIST-standardized Post-Quantum Cryptography (PQC) algorithms into the Lux Network, providing quantum-resistant security for all cryptographic operations. The implementation includes ML-KEM (FIPS 203) for key encapsulation, ML-DSA (FIPS 204) for digital signatures, and hybrid modes combining PQC with classical cryptography for defense-in-depth.

## Motivation

With the advancement of quantum computing, current cryptographic algorithms (RSA, ECDSA, ECDH) will become vulnerable to quantum attacks. The Lux Network must proactively adopt quantum-resistant cryptography to ensure long-term security of user assets and network operations. This proposal standardizes on NIST's recently finalized PQC algorithms to provide:

1. **Quantum Resistance**: Protection against future quantum computer attacks
2. **Standards Compliance**: Adherence to NIST FIPS 203/204 standards
3. **Hybrid Security**: Combined PQC+Classical for maximum protection
4. **Privacy Tiers**: Adaptive security levels based on deployment environment
5. **Seamless Migration**: Gradual transition path from classical to PQC

## Specification

### Algorithm Selection

#### ML-KEM (Module-Lattice Key Encapsulation Mechanism)
- **ML-KEM-512**: NIST Level 1 (128-bit security)
- **ML-KEM-768**: NIST Level 3 (192-bit security) [DEFAULT]
- **ML-KEM-1024**: NIST Level 5 (256-bit security)

#### ML-DSA (Module-Lattice Digital Signature Algorithm)
- **ML-DSA-44**: NIST Level 2 (128-bit security)
- **ML-DSA-65**: NIST Level 3 (192-bit security) [DEFAULT]
- **ML-DSA-87**: NIST Level 5 (256-bit security)

### Privacy Tiers

| Tier | Environment | ML-KEM | ML-DSA | Features |
|------|-------------|---------|---------|----------|
| 0 | Open Data | 768 | 65 | Basic quantum resistance |
| 1 | At-Rest Encryption | 768 | 65 | + SIM key protection |
| 2 | CPU TEE | 768 | 65 | + FIPS mode, attestation |
| 3 | GPU CC (H100) | 1024 | 87 | + Encrypted DMA |
| 4 | GPU TEE-I/O (Blackwell) | 1024 | 87 | + NVLink protection |

### Hybrid Cryptography

Combines ML-KEM with X25519 using SP 800-56C compliant KDF:

```rust
pub enum HybridMode {
    MlKem512X25519,
    MlKem768X25519,  // DEFAULT
    MlKem1024X25519,
}
```

### Key Derivation Function

SP 800-56C Rev. 2 compliant HKDF:
- HKDF-SHA256
- HKDF-SHA384 (DEFAULT for hybrid)
- HKDF-SHA512

### Implementation Architecture

```
lux-node/
├── lux-pqc/           # PQC implementation
│   ├── kem/           # ML-KEM
│   ├── signature/     # ML-DSA
│   ├── hybrid/        # Hybrid modes
│   └── kdf/           # Key derivation
├── lux-kbs/           # Key Broker Service
│   ├── vaults/        # PQC-enhanced vaults
│   └── attestation/   # TEE verification
└── lux-crypto/        # Integration layer
```

### Transaction Format

PQC-enhanced transactions include:
1. **Quantum-safe signatures** using ML-DSA
2. **Hybrid key exchange** for confidential transactions
3. **Backward compatibility** with classical crypto

### Network Protocol Updates

1. **Handshake**: Support PQC+Classical hybrid
2. **Message Authentication**: ML-DSA signatures
3. **Key Agreement**: ML-KEM with X25519 fallback
4. **Version Negotiation**: Automatic algorithm selection

## Rationale

### Why ML-KEM-768 and ML-DSA-65 as defaults?

These provide NIST Level 3 security (192-bit), offering strong protection against both classical and quantum attacks while maintaining reasonable performance and key sizes. This matches current industry recommendations for long-term security.

### Why Hybrid Mode?

Hybrid cryptography provides defense-in-depth by combining:
- **PQC algorithms**: Protection against quantum attacks
- **Classical algorithms**: Protection against potential PQC vulnerabilities
- **Combined security**: Attacker must break both to compromise the system

### Why Privacy Tiers?

Different deployment environments have varying security requirements. Privacy tiers automatically select appropriate algorithm strengths based on the environment, from basic quantum resistance to full TEE-I/O protection.

## Backwards Compatibility

The implementation maintains full backward compatibility:

1. **Protocol Negotiation**: Nodes advertise PQC support
2. **Fallback Mode**: Classical crypto for legacy nodes
3. **Migration Period**: Gradual transition over 12 months
4. **Dual Signatures**: Support both PQC and classical during transition

## Test Cases

### Unit Tests
- ML-KEM key generation, encapsulation, decapsulation
- ML-DSA key generation, signing, verification
- Hybrid mode secret combination
- KDF compliance tests

### Integration Tests
- End-to-end transaction signing with ML-DSA
- Network handshake with hybrid mode
- Privacy tier configuration
- Cross-version compatibility

### Performance Benchmarks
- Target: <100μs for ML-KEM-768 operations
- Target: <300μs for ML-DSA-65 signing
- Target: <10% overhead for hybrid mode

## Implementation

### Phase 1: Core PQC Library (Complete)
- ML-KEM implementation via liboqs
- ML-DSA implementation via liboqs
- Hybrid mode support
- KDF implementation

### Phase 2: Network Integration (Q1 2025)
- Protocol negotiation
- Handshake updates
- Message authentication

### Phase 3: Transaction Support (Q2 2025)
- PQC transaction format
- Wallet integration
- Block validation

### Phase 4: Full Migration (Q3 2025)
- Deprecate classical-only mode
- Mandatory PQC for new deployments
- Legacy support via bridges

## Security Considerations

### Quantum Attack Resistance
- ML-KEM resistant to Shor's algorithm
- ML-DSA resistant to quantum period finding
- Hybrid mode provides redundancy

### Side-Channel Protection
- Constant-time implementations via liboqs
- Memory zeroization for sensitive data
- Protected key storage in TEEs

### Algorithm Agility
- Easy migration between parameter sets
- Configuration-driven selection
- Future algorithm support (SLH-DSA)

## Dependencies

- **liboqs** v0.11+: NIST reference implementations
- **x25519-dalek**: Classical ECDH for hybrid
- **hkdf**: SP 800-56C compliant KDF
- **chacha20poly1305**: AEAD for key wrapping

## References

1. [FIPS 203](https://csrc.nist.gov/pubs/fips/203/final): Module-Lattice-Based Key-Encapsulation Mechanism
2. [FIPS 204](https://csrc.nist.gov/pubs/fips/204/final): Module-Lattice-Based Digital Signature Standard
3. [SP 800-56C Rev. 2](https://csrc.nist.gov/pubs/sp/800/56/c/r2/final): Key Derivation Methods
4. [LP-4](./lp-4.md): Quantum-Resistant Cryptography Integration in Lux
5. [LP-5](./lp-5.md): Lux Quantum-Safe Wallets and Multisig Standard

## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
